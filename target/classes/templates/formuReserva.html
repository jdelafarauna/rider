<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="/css/EFormuReserva.css">
    <link rel="stylesheet" type="text/css" href="/css/ECabecera.css">
    <title>Formulario de Reserva</title>
</head>
<body>

    <nav class="navbar">
        <img src="../../Imagenes/logoC.png" alt="logo">
        <div class="containerCabecera">
            
            <ul class="nav-links">
                <li><a href="indice">Inicio</a></li>
                <li><a href="calendario">Calendario</a></li>
                <li><a href="formuReserva">Reservas</a></li>
                <li><a href="concursos">Concursos</a></li>
                <li><a href="Contacto">Contacto</a></li>
            </ul>
        </div>
    </nav>

    <div class="form-container">
        <h1>Datos de Reserva</h1>
        <form id="reservaForm">
            <div class="form-group">
                <label for="organica">Orgánica:</label>
                <input type="text" id="organica" name="organica">
            </div>
            
            <div class="form-group">
                <label for="concurso">Concurso:</label>
                <input type="text" id="concurso" name="concurso">
            </div>
            
            <div class="form-group">
                <label for="ambito">Ámbito:</label>
                <input type="text" id="ambito" name="ambito">
            </div>
            
            <div class="form-group">
                <label for="fecha">Fecha:</label>
                <input type="date" id="fecha" name="fecha">
            </div>
            
            <div class="form-group">
                <label for="prueba">Prueba:</label>
                <input type="text" id="prueba" name="prueba">
            </div>
            
            <button type="button" onclick="enviarReserva()">Enviar</button>
           
            <button type="button" onclick="mostrarReservas()">Todas las reservas</button>
        </form>
    </div>

    <script>
        function mostrarReservas() {
       
        window.location.href = "/reserva";
    }
        async function enviarReserva() {
            var organica = document.getElementById("organica").value;
            var concurso = document.getElementById("concurso").value;
            var ambito = document.getElementById("ambito").value;
            var fecha = document.getElementById("fecha").value;
            var prueba = document.getElementById("prueba").value;

            if (!organica || !concurso || !ambito || !fecha || !prueba) {
                alert("Por favor, complete todos los campos del formulario.");
                return;
            }

            var reservaData = {
                organica: organica,
                concurso: concurso,
                ambito: ambito,
                fecha: fecha,
                prueba: prueba
            };
            try {
                const response = await fetch('https://riderrank.onrender.com/apiReserva/posts', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(reservaData)
                });

                if (response.ok) {
                    alert("Reserva creada exitosamente!");
                    document.getElementById("reservaForm").reset(); // Limpiar el formulario después del envío exitoso
                } else {
                    const errorMessage = await response.text();
                    alert("Error al crear la reserva: " + errorMessage);
                }
            } catch (error) {
                console.error("Error al enviar la solicitud:", error);
                alert("Error al enviar la solicitud. Por favor, inténtalo de nuevo más tarde.");
            }
        }

        document.addEventListener('DOMContentLoaded', function() {

            var today = new Date();
            var year = today.getFullYear();
            var month = (today.getMonth() + 1).toString().padStart(2, '0');
            var day = today.getDate().toString().padStart(2, '0');
            var fechaActual = `${year}-${month}-${day}`;

            var inputFecha = document.getElementById('fecha');
            inputFecha.min = fechaActual;
        });
    </script>
</body>
</html>
